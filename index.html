<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jump Cat Ad Server</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://adsgram.ai/js-sdk/direct-link.js"></script>
</head>
<body style="background-color: #1a1a1a; color: white; text-align: center; font-family: sans-serif; padding-top: 100px;">

    <div id="status">جاري تجهيز الإعلان...</div>
    <br>
    <button id="showAdBtn" style="padding: 20px 40px; font-size: 20px; background: #2ecc71; color: white; border: none; border-radius: 15px; display: none;">
        ✅ تشغيل الإعلان الآن
    </button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // إعداد المحرك مع خاصية التجربة (Debug) لضمان العمل
        const AdController = window.Adsgram.init({ 
            blockId: "19316", 
            debug: true 
        });

        // التأكد من جاهزية الإعلان قبل إظهار الزر
        document.getElementById('status').innerText = "اضغط على الزر للمشاهدة والربح";
        document.getElementById('showAdBtn').style.display = "inline-block";

        document.getElementById('showAdBtn').onclick = () => {
            AdController.show().then((result) => {
                // إرسال البيانات للبوت (Pydroid 3)
                tg.sendData("ad_watched_successfully");
                tg.close();
            }).catch((error) => {
                console.error(error);
                alert("عذراً، لم يتوفر إعلان حالياً. حاول مرة أخرى بعد قليل.");
            });
        };
    </script>
</body>
</html>
